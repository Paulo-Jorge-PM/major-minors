{% extends "layout.html" %}

{% block head %}
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500;800&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/3d9627186b.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles-minorias.css') }}" type="text/css">
{% endblock %}

{% block content %}
<div id="minorias">


    <div class="bgimg mulheres">
        <span>MULHERES</span>
    </div>


    <div class="auto-responsive-container">
        <div class="years-text">
            <h1 class="purple-title">Menções em notícias ao longo dos anos</h1>
            <p>Com o decorrer dos anos, o fosso entre os direitos das mulheres e homens tem visto uma diminuição e notícias positivas relativas a feitos de mulheres tiram lugar aos artigos com referência a descriminação. No entanto, polémicas associadas a violência doméstica, diferenças salariais, relatos de descriminação ou abuso, estão longe de estar extintos, continuando presentes anualmente. A imagem da mulher na sociedade tem sofrido alterações, bem como o carácter das notícias a que estas estão associadas.</p>
        </div>
        <div class="years-graph">
            <canvas id="yearsChart"></canvas>
        </div>
    </div>

    <div class="in-portugal-container mulheres">
        <div class="portugal-map">
            <img src="{{ url_for('static', filename='images/minorias/portugal-map.PNG') }}" alt="Portugal Map">
        </div>
        <div class="in-portugal-content">
            <div class="years-text">
                <span style="font-size: 13px; color: white;">Contextualização</span>
                <h1 class="white-title">Mulheres em Portugal</h1>
                <p style="color: white;">Apesar da aproximação dos direitos dos homens, as mulheres enfrentam ainda algumas situações de descriminação.
                    Em 2009, existiam apenas 27% de mulheres portuguesas no parlamento e 7% entre os presidentes das autarquias.
                    Em 1991, os salários das mulheres portuguesas eram inferiores aos dos homens em 27%. Atualmente, os números mostram que foram poucas as alterações no que diz respeito à desigualdade salarial entre os géneros em Portugal. 
                    O número de vítimas mortais em casos de violência doméstica a mulheres não para de aumentar, desde 2004 já foram assassinadas mais de 500 mulheres.
                    </p>
            </div>
        </div>
        <div class="cigano-triangle">
            <img src="{{ url_for('static', filename='images/minorias/mulheres-triangle.PNG') }}" alt="Mulheres">
        </div>
    </div>

    <div class="auto-responsive-container">
        <div class="sentiment-graph">
            <canvas id="sentimentRadarChart"></canvas>
        </div>
        <div class="sentiment-text">
            <h1 class="purple-title">Análise do sentimento</h1>
            <p>Foram analisados todos os títulos das notícias relacionadas com mulheres e foi extraído o seu "sentimento". A análise de sentimento é usada para determinar o tom emocional associado a sequências de palavras. O intuito desta análise, neste contexto, é o de permitir extrair conclusões sobre qual o carácter das notícias que maioritarimente incidem sobre cada uma das minorias. No caso das mulheres, a maioria das notícias possui um carácter negativo.</p>
        </div>
    </div>

    <div class="facts purple-background">
        <div class="title-center">
            <h1 class="white-title">Factos sobre as mulheres</h1>
        </div>
        <div class="fact">
            <h2>Globalmente, as mulheres assumem 75% dos cuidados não pagos e do trabalho doméstico. <i class="fas fa-check" style="color:green";></i></h2>
            <p>Público, 2019</p>
        </div> 
        <div class="fact right">
            <h2><i class="fas fa-check" style="color:green";></i> Na Alemanha as mulheres recebem, em média, menos 50% do que os homens.</i></h2>
            <p style="text-align: right;">Jornal de Notícias, 2015</p>
        </div> 
        <div class="fact">
            <h2>OCDE considera Portugal o quinto país com menor nível de discriminação contra mulheres. <i class="fas fa-check" style="color:green";></i></h2>
            <p>Público, 2019</p>
        </div> 
        <div class="fact right">
            <h2><i class="fas fa-check" style="color:green";></i> 27 países obrigam por lei a mulher a obedecer ao marido e outros 24 exigem a permissão do marido para que a mulher possa ter uma profissão.</i></h2>
            <p style="text-align: right;">Público, 2019</p>
        </div>
    </div>


    <div class="title-center">
        <h1 class="purple-title">Distribuição geográfica dos locais mencionados</h1>
    </div>

    <div class="auto-responsive-container geographic-distribution">
        <div>
            <img class="separated-map-img" src="{{ url_for('static', filename='images/minorias/portugal-map-separated.png') }}" alt="">
            {% for row in countByCities: %}{% if loop.index != 1: %}<br><br><br>{% endif %}<p class="map-zones"><b>{{row["city"]["value"]}}</b><br>{{row["articles"]["value"]}} Menções</p>{% endfor %}
        </div>
        <div>
            <img class="world-img" src="{{ url_for('static', filename='images/minorias/earth-vector-icon-png_296088.jpg') }}" alt="">
            {% for row in countByCountry: %}{% if loop.index != 1: %}<br><br><br>{% endif %}<p class="map-zones"><b>{{row["country"]["value"]}}</b><br>{{row["articles"]["value"]}} Menções</p>{% endfor %}
        </div>
    </div>

    <div class="geographic-info">
        <span>A distribuição geográfica dos locais mais mencionados em notícias no contexto desta minoria é bastante diversificada.</span>
        <div class="divider div-transparent">   </div>
    </div>

    <div class="title-center">
        <h1 class="purple-title">Algumas mulheres importantes na luta pelos seus direitos</h1>
    </div>

    <div class="relevant-people-container purple">
        <div class="relevant-person">
            <img src="{{ url_for('static', filename='images/minorias/mulheres-betty.PNG') }}" alt="Ricardo Quaresma">
            <h2>Betty Friedan</h2>
            <span style="color: grey;">Ativista Feminista</span>
        </div>
        <div class="relevant-person">
            <img src="{{ url_for('static', filename='images/minorias/mulheres-simone.PNG') }}" alt="Simone de Beauvoir">
            <h2>Simone de Beauvoir</h2>
            <span style="color: grey;">Escritora/Ativista Feminista</span>
        </div>
        <div class="relevant-person">
            <img src="{{ url_for('static', filename='images/minorias/homo-billie.PNG') }}" alt="Billie Jean King">
            <h2>Billie Jean King</h2>
            <span style="color: grey;">Ex-tenista/Atvista defensora da igualdade salarial no desporto</span>
        </div>
        <div class="relevant-person">
            <img src="{{ url_for('static', filename='images/minorias/mulheres-malala.PNG') }}" alt="Malala Yousafzai">
            <h2>Malala Yousafzai</h2>
            <span style="color: grey;">Ativista/Defensora da igualdade de direitos</span>
        </div>
        
    </div>



    <div class = "pizza-container mulheres">
        <div class="pieID--operations pie-chart--wrapper" id="lol">
            <h1>Palavras-chave mais mencionadas</h1>
            <div class="pie-chart">
                <div class="pie-chart__pie"></div>
                <ul class="pie-chart__legend">
                    {% for row in countByKeywords: %}<li><em>{{row["keyword"]["value"]}}</em><span>{{row["articles"]["value"]}}</span></li>{% endfor %}
                </ul>
            </div>
        </div>

    </div>

    <div class = "title-most-mentioned purple-background-wave">
        <h1 class="white-title">Figuras com maior número de menções em notícias</h1>
    </div>

    <div class="most-mentioned-container purple-background-wave">     
        {% for row in countByPeople: %}
        <div class = "famous-person">
            <img class ="famous-pic image-cropper" src="{{ url_for('static', filename='images/persons/'+row['person']['value'].lower().replace(' ','_')+'.jpg') }}">
            <h2>{{row["person"]["value"]}}</h2>
            <p class="famous-job">{% if "job" in row: %}{{row["job"]["value"]}}{% endif %}</p>
            <p class="n-mentions">Menções: {{row["articles"]["value"]}}</p>
        </div>
        {% endfor %}

    </div>

    <div class = "title-most-mentioned purple-background-wave">
        <h1 class="white-title">Partidos políticos mencionados em notícias</h1>
    </div>

    <div class="most-mentioned-container purple-background-wave">
        
        {% for row in countByPoliticalParty: %}
        <div class = "partido">
            <img class ="famous-pic image-cropper" src="{{ url_for('static', filename='images/partidos/'+row['party']['value'].lower().replace(' ','_').replace('!','')+'.png') }}">
            <h2>{{row["party"]["value"].upper()}}</h2>
            <p class="n-mentions">Menções: {{row["articles"]["value"]}}</p>
        </div>
        {% endfor %}  
        
        
    </div>

    <div class = "title-most-relevant">
        <img class="wave-P" src="{{ url_for('static', filename='images/minorias/P-mulheres.PNG') }}" style="width:100%">
        <h1 class="purple-title">Algumas notícias relevantes</h1>
    </div>

    <div class="auto-responsive-container noticias-container ">
        {% for row in topArticles: %}
        <div class="noticia-card">
            <img src="{{ url_for('static', filename='images/articles/'+articleImages[loop.index-1])}}" style="width: 100%; height: 150px; object-fit: cover; object-position: 0 40%; filter: grayscale(70%);">
            <h5>{{row["title"]["value"]}}</h5>
            <p>{% if row["preview"]["value"]: %}{{row["preview"]["value"][:200]}}...{% else: %}{{row["text"]["value"][:200]}}...{% endif %}</p>
        </div>
        {% endfor %}        
    </div>

    <div class="see-more-news">
        <a href="{{ url_for('articles.articles')}}/{{minority}}">Ver todas</a>
    </div>


</div>


{% block end %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    
<script>
function isScrolledIntoView(elem)
{
    var docViewTop = $(window).scrollTop();
    var docViewBottom = docViewTop + $(window).height();

    var elemTop = $(elem).offset().top;
    var elemBottom = elemTop + $(elem).height();

    return ((elemTop <= docViewBottom) && (elemBottom >= docViewTop));
}

$(window).scroll(function() {
    if (isScrolledIntoView('#yearsChart')) {
        if (inView) { return; }
        inView = true;
        var ctx = document.getElementById('yearsChart').getContext('2d');

        var myBarChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: [{% for row in articlesByYear: %}{% if loop.index != 1 %},{% endif %}'{{row["year"]["value"]}}'{% endfor %}],
            datasets: [{
                label: 'Nº de Notícias',
                backgroundColor: 'rgb(100,0,98)', //received as argument
                borderColor: 'rgb(100,0,98)', //received as argument
                data: [{% for row in articlesByYear: %}{% if loop.index != 1 %},{% endif %}{{row["articles"]["value"]}}{% endfor %}] //received as argument
            }]
          },  
          options: {}
        });
    } else {
        inView = false;  
    }
});


$(window).scroll(function() {
    if (isScrolledIntoView('#sentimentRadarChart')) {
        if (inViewRadar) { return; }
        inViewRadar = true;
        var ctx = document.getElementById('sentimentRadarChart').getContext('2d');

        var myRadarChart = new Chart(ctx, {
          type: 'radar',
          data: {
            labels: ['Positivo', 'Negativo', 'Neutro'],
            datasets: [{
                label: 'Sentimento',
                backgroundColor: 'rgb(100,0,98)',
                data: [{{ countPositive }}, {{ countNegative }}, {{ countNeutral }}]
            }]
          },  
          options: {}
        });
    } else {
        inViewRadar = false;  
    }
});

function sliceSize(dataNum, dataTotal) {
  return (dataNum / dataTotal) * 360;
}

function addSlice(id, sliceSize, pieElement, offset, sliceID, color) {
  $(pieElement).append("<div class='slice "+ sliceID + "'><span></span></div>");
  var offset = offset - 1;
  var sizeRotation = -179 + sliceSize;

  $(id + " ." + sliceID).css({
    "transform": "rotate(" + offset + "deg) translate3d(0,0,0)"
  });

  $(id + " ." + sliceID + " span").css({
    "transform"       : "rotate(" + sizeRotation + "deg) translate3d(0,0,0)",
    "background-color": color
  });
}

function iterateSlices(id, sliceSize, pieElement, offset, dataCount, sliceCount, color) {
  var
    maxSize = 179,
    sliceID = "s" + dataCount + "-" + sliceCount;

  if( sliceSize <= maxSize ) {
    addSlice(id, sliceSize, pieElement, offset, sliceID, color);
  } else {
    addSlice(id, maxSize, pieElement, offset, sliceID, color);
    iterateSlices(id, sliceSize-maxSize, pieElement, offset+maxSize, dataCount, sliceCount+1, color);
  }
}






function createPie(id) {
  var
    listData      = [],
    listTotal     = 0,
    offset        = 0,
    i             = 0,
    pieElement    = id + " .pie-chart__pie"
    dataElement   = id + " .pie-chart__legend"

    color         = [
      "rgb(187,228,255)",
      "rgb(2,166,209)",
      "rgb(5,116,206)",
      "rgb(239,71,111)",
      "rgb(255,209,102)",
      "rgb(6,214,160)",
      "rgb(172,78,221)",
      "rgb(255,140,62)",
      "rgb(0,188,212)",
      "rgb(194,24,91)",
      "rgb(230,74,25)",
      "rgb(103,58,183)"
    ];

  color = shuffle( color );

  $(dataElement+" span").each(function() {
    listData.push(Number($(this).html()));
  });

  for(i = 0; i < listData.length; i++) {
    listTotal += listData[i];
  }

  for(i=0; i < listData.length; i++) {
    var size = sliceSize(listData[i], listTotal);
    iterateSlices(id, size, pieElement, offset, i, 0, color[i]);
    $(dataElement + " li:nth-child(" + (i + 1) + ")").css("border-color", color[i]);
    offset += size;
  }
}

function shuffle(a) {
    var j, x, i;
    for (i = a.length; i; i--) {
        j = Math.floor(Math.random() * i);
        x = a[i - 1];
        a[i - 1] = a[j];
        a[j] = x;
    }

    return a;
}

function createPieCharts() {
  createPie('.pieID--region' );
  createPie('.pieID--operations' );
}





$(window).scroll(function() {
    if (isScrolledIntoView('#lol')) {
        if (inViewPizza) { return; }
        inViewPizza = true;
        createPieCharts();
    } else {
        inViewPizza = false;  
    }
});
</script>

{% endblock %}

{% endblock %}